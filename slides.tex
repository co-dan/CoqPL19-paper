\documentclass{beamer}

\usepackage{pgfpages}
\setbeameroption{show notes on second screen=bottom}

\usepackage{graphicx}
\usepackage{xspace}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{color}
\usepackage[many]{tcolorbox}


\input{listings-coq.tex}

\newcommand{\N}{\mathbb{N}}
\newcommand{\ltac}{\mbox{$\mathcal{L}_{tac}$}}

\usetheme{Madrid}
\usecolortheme{scott}
\useoutertheme{scott}
\setbeamertemplate{navigation symbols}{}

\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\title{Reification of shallow-embedded DSLs in Coq with automated verification}

\author{Vadim Zaliva \textsuperscript{1},Matthieu Sozeau \textsuperscript{2}}
\institute[A]{\textsuperscript{1}Carnegie Mellon University\\ %
\textsuperscript{2}Inria \& IRIF, University Paris 7
}

\date{\today}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}


\begin{frame}{Shallow and Deep Embedding}
  There are several ways to embed a domain specific language (DSL) in
  a host language (HL):
  \medskip
  \begin{description}
  \item[Deep] DSL's AST is represented as HL data structures and
    semantic is explicitly assigned to it.
  \item[Shallow] DSL is a subset of HL and semantic is inherited from HL.
  \end{description}

  \medskip
  The shallow embedding is excellent for quick prototyping, as it
  allows quick extension or modification of the embedded language.
  Meanwhile, deep embeddings are better suited for code transformation
  and compilation.
  
\end{frame}

\begin{frame}[fragile]{An Example of Shallow Embedding in Coq}

  As an example let us consider a simple language of arithmetic
  expressions on natural numbers. It is shallow-embedded in Gallina
  and includes constants, bound variables, and three arithmetic
  operators: $+$, $-$, and $*$.
  
  \medskip
  Provided that $a, b, c, x \in \N$, the expression below is an
  example of a valid expression in the source language:
  \medskip
  \begin{lstlisting}[language=Coq, mathescape=true, basicstyle=\large,
    frame=single]
    2 + a*x*x + b*x + c.
  \end{lstlisting}

\end{frame}

\begin{frame}[fragile]{An Example of Deep Embedding in Coq}

  A deep-embedded variant of the same language includes the same
  operators but will be defined by an inductive type of its AST:

  \begin{lstlisting}[language=Coq, mathescape=true,
    frame=single, basicstyle=\footnotesize]
    Inductive NExpr: Type :=
    | NVar  : nat -> NExpr (* using de Bruijn indices *)
    | NConst: nat -> NExpr
    | NPlus : NExpr -> NExpr -> NExpr
    | NMinus: NExpr -> NExpr -> NExpr
    | NMult : NExpr -> NExpr -> NExpr.
  \end{lstlisting}

  Our sample expression, in deep-embedded target language, looks like:
  
  \begin{lstlisting}[language=Coq, mathescape=true,
    basicstyle=\footnotesize, frame=single]
    NPlus (NPlus (NPlus (NConst 2)
      (NMult (NMult (NVar 3) (NVar 0)) (NVar 0)))
        (NMult (NVar 2) (NVar 0))) (NVar 1)
  \end{lstlisting}
  
\end{frame}

\end{document}
